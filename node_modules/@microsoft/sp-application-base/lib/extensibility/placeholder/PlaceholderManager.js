import { ServiceKey, Validate } from '@microsoft/sp-core-library';
import { SPEvent, SPEventArgs, _SPEventManager } from '@microsoft/sp-core-library';
import Placeholder from './Placeholder';
import PlaceholderName from './PlaceholderName';
var PlaceholderManager =  (function () {
    function PlaceholderManager(serviceScope) {
        this._isEnabled = false;
        this._changedEvent = new SPEvent(PlaceholderManager.placeholdersChangedEventName);
        this._placeholders = new Map();
        this._placeholders.set(PlaceholderName.Top, this._createPlaceholder(PlaceholderName.Top));
        this._placeholders.set(PlaceholderName.Bottom, this._createPlaceholder(PlaceholderName.Bottom));
    }
    Object.defineProperty(PlaceholderManager.prototype, "changedEvent", {
        get: function () {
            return this._changedEvent;
        },
        enumerable: true,
        configurable: true
    });
    PlaceholderManager.prototype.initializePlaceholders = function (definitions) {
        var _this = this;
        Validate.isNotNullOrUndefined(definitions, 'definitions');
        definitions.forEach(function (def) { return _this.addPlaceholder(def.name, def.domElement); });
    };
    PlaceholderManager.prototype.addPlaceholder = function (name, domElement) {
        Validate.isTrue(this.placeholders.has(name), 'placeholder exists');
        this._placeholders.get(name).attachToApplication(domElement);
        _SPEventManager.instance.raiseStickyEvent(PlaceholderManager.placeholdersChangedEventName, new SPEventArgs());
    };
    PlaceholderManager.prototype.removePlaceholder = function (name) {
        Validate.isTrue(this.placeholders.has(name), 'placeholder exists');
        this._placeholders.get(name).detachFromApplication();
        _SPEventManager.instance.raiseStickyEvent(PlaceholderManager.placeholdersChangedEventName, new SPEventArgs());
    };
    Object.defineProperty(PlaceholderManager.prototype, "isEnabled", {
        get: function () {
            return this._isEnabled;
        },
        enumerable: true,
        configurable: true
    });
    PlaceholderManager.prototype._enable = function () {
        this._isEnabled = true;
    };
    Object.defineProperty(PlaceholderManager.prototype, "placeholders", {
        get: function () {
            return this._placeholders;
        },
        enumerable: true,
        configurable: true
    });
    PlaceholderManager.prototype._createPlaceholder = function (name) {
        return new Placeholder({ name: name, domElement: document.createElement('div') }, this);
    };
    PlaceholderManager.serviceKey = ServiceKey.create('sp-application-base:PlaceholderManager', PlaceholderManager);
    PlaceholderManager.placeholdersChangedEventName = 'placeholders.changedEvent';
    return PlaceholderManager;
}());
export default PlaceholderManager;
