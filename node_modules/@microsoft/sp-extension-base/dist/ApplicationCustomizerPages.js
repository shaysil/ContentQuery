var NEWS_PAGE_PATH = '/_layouts/15/news.aspx';
var ApplicationCustomizerPages =  (function () {
    function ApplicationCustomizerPages() {
    }
    ApplicationCustomizerPages.prototype.TestName = function () {
        return 'ApplicationCustomizer Pages Test';
    };
    ApplicationCustomizerPages.prototype.TestOwner = function () {
        return 'patsppplat';
    };
    ApplicationCustomizerPages.prototype.TestOwnerTeam = function () {
        return 'DevPlat\\SPFX';
    };
    ApplicationCustomizerPages.prototype.TestIncludeScripts = function () {
        return [
            '<ProductScriptsLocation>msajaxbundle.debug.js',
            '<ProductScriptsLocation>sp.runtime.debug.js',
            '<ProductScriptsLocation>sp.debug.js',
            '<TestLocation>/TabTaskLib.debug.js',
            '<AzureTaskLibLocation>/sp-tab-tasklib.js'
        ];
    };
    ApplicationCustomizerPages.prototype.TestSetup = function () {
        SPTaskLib.PageUtil.SetDebugManifests();
        TAB.Log.Comment('ApplicationCustomizer Pages start');
    };
    ApplicationCustomizerPages.prototype.TestRun = function () {
        this._singleAppCustomizerTest();
        this._inlineAppCustomizerTest();
        this._twoAppCustomizerTest();
        TAB.Log.AddTaskPass('Test complete');
    };
    ApplicationCustomizerPages.prototype._singleAppCustomizerTest = function () {
        var customActionParams = JSON.stringify({
            'e6ebfc48-d18a-46c2-ad11-8133c5badf5e': {
                location: 'ClientSideExtension.ApplicationCustomizer',
                properties: {
                    headerMessage: 'Header area of the page',
                    footerMessage: 'Footer area in the page'
                }
            }
        });
        var spQueryParams = {
            loadSPFX: true,
            customActions: customActionParams
        };
        var pageUrl = SPTaskLib.PageUtil.CreatePageUrl(NEWS_PAGE_PATH, spQueryParams);
        TAB.AddTask(TAB.LoadPage(pageUrl));
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('YellowHeaderPlaceholderMessage');
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('YellowFooterPlaceholderMessage');
        TAB.Log.AddTaskPass('Single application customizer test pass');
    };
    ApplicationCustomizerPages.prototype._inlineAppCustomizerTest = function () {
        var customActionParams = JSON.stringify({
            'f1a54a91-7bad-4029-833e-89cd74fd092e': {
                location: 'ClientSideExtension.ApplicationCustomizer',
                properties: {
                    headerMessage: 'Header area of the page - Inline placeholder changed callback',
                    footerMessage: 'Footer area in the page - Inline placeholder changed callback'
                }
            }
        });
        var spQueryParams = {
            loadSPFX: true,
            customActions: customActionParams
        };
        var pageUrl = SPTaskLib.PageUtil.CreatePageUrl(NEWS_PAGE_PATH, spQueryParams);
        TAB.AddTask(TAB.LoadPage(pageUrl));
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('BlueInlineHeaderPlaceholderMessage');
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('BlueInlineFooterPlaceholderMessage');
        TAB.Log.AddTaskPass('Inline application customizer test pass');
    };
    ApplicationCustomizerPages.prototype._twoAppCustomizerTest = function () {
        var customActionParams = JSON.stringify({
            'e6ebfc48-d18a-46c2-ad11-8133c5badf5e': {
                location: 'ClientSideExtension.ApplicationCustomizer',
                sequence: 1,
                properties: {
                    headerMessage: 'Yellow Header area of the page',
                    footerMessage: 'Yellow Footer area in the page'
                }
            },
            'a11f15c3-51a3-4f9f-bc7a-e50da31a86b3': {
                location: 'ClientSideExtension.ApplicationCustomizer',
                sequence: 2,
                properties: {
                    headerMessage: 'Green Header area of the page',
                    footerMessage: 'Green Footer area in the page'
                }
            }
        });
        var spQueryParams = {
            loadSPFX: true,
            customActions: customActionParams
        };
        var pageUrl = SPTaskLib.PageUtil.CreatePageUrl(NEWS_PAGE_PATH, spQueryParams);
        TAB.AddTask(TAB.LoadPage(pageUrl));
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('YellowHeaderPlaceholderMessage');
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('YellowFooterPlaceholderMessage');
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('GreenHeaderPlaceholderMessage');
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('GreenFooterPlaceholderMessage');
        TAB.Log.AddTaskPass('Two application customizer can load at the the same time');
    };
    return ApplicationCustomizerPages;
}());
TabTest = ApplicationCustomizerPages;
